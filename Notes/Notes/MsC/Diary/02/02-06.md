Gonna check how deepcell works

The model gets downloaded using an access token stored in .bashrc, which is not good if used on the cluster server. Might have to fix this by copying the download code, and changing the location in which the access token is gotten from. For now, I will just download the model and explore it from there.

I was wrong, the export command is just temporary variable, but the problem of where the model is saved remains

****

What is downloaded using `download_model()` are just weights. I'll have to check the cellsum_pipeline how the model is instansiated

It starts inside:
`/home/jonathan/anaconda3/envs/i2c_venv/lib/python3.11/site-packages/cellSAM/cellsam_pipeline.py` 
and function `cellsam_pipeline`

Creation starts at line 172, but model_path is declared as None even in the example, so the else statement is what runs. There it calls the function `get_model()`, which is imported from `model.py` function `get_model`

Inside the functions, variables model are declared, one where the architecture is loaded as per config, and load_state_dict from model_path. The default model path is `.deepcell/models`

<u>Note:</u>
load state dict can therefore be used from wherever

The architecture is loaded from `sam_inference.py` function `CellSAM`, and passes config as argument.
The argument is loaded using `yaml`, which needs a config_path. The config path is the installed package `cellSAM` and inside there the `modelconfig.yaml`.

Things to investigate:
* config
* the other functions and what they are for
* How the forward function works
* (DONE) Where the architecture is imported from
* Follow the construction pipeline and see if the image encoder can be loaded in a single set
* (DONE )Find the license...
[segment-anything/LICENSE at main Â· facebookresearch/segment-anything](https://github.com/facebookresearch/segment-anything/blob/main/LICENSE)
* Analyze what the license actually means
* Inside sam_inference, calls to self.model is made, check if these affect image_encoder in any way

****
<u>Model</u>
Seems to be imported from `sam_model_registry`, which is imported from
`/home/jonathan/anaconda3/envs/i2c_venv/lib/python3.11/site-packages/segment_anything/__init__.py` which inside that leads to importing from `build_sam.py` the function `sam_model_registry`, which executes different model architectures depending on which model name is used. The default is `vit_b`.

The function then executes as follows:
`build_sam_vit_b > _build_sam(params) > Sam(params)`

And `Sam` is inside `.modeling > sam.py`

`Sam` initializes the different parts of the model, namely the visual encoder, the prompt encoder, and mask decoder.

The decoder is loaded from `models/image_encoder.py` function `ImageEncoderViT`

And there it fahaaaaking is... there is the architecture

AND FUCKING POGGGGGYYYYYYY THE WEIGHT DICTIONARY IS LABELLED